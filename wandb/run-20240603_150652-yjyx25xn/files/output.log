Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Logging to ./ppo_tensorboard/PPO_1
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 486      |
|    ep_rew_mean     | -1.48    |
| time/              |          |
|    fps             | 868      |
|    iterations      | 1        |
|    time_elapsed    | 2        |
|    total_timesteps | 2048     |
---------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py:248: UserWarning: Using a target size (torch.Size([1])) that is different to the input size (torch.Size([64])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  value_loss = F.mse_loss(rollout_data.returns, values_pred)
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 571         |
|    ep_rew_mean          | -0.5        |
| time/                   |             |
|    fps                  | 669         |
|    iterations           | 2           |
|    time_elapsed         | 6           |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.012632644 |
|    clip_fraction        | 0.114       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.09       |
|    explained_variance   | 0.323       |
|    learning_rate        | 0.0003      |
|    loss                 | 1.64        |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.00078    |
|    value_loss           | 4.18        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 575         |
|    ep_rew_mean          | -0.61       |
| time/                   |             |
|    fps                  | 639         |
|    iterations           | 3           |
|    time_elapsed         | 9           |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.011965395 |
|    clip_fraction        | 0.293       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.08       |
|    explained_variance   | 0.334       |
|    learning_rate        | 0.0003      |
|    loss                 | 63          |
|    n_updates            | 20          |
|    policy_gradient_loss | 0.00682     |
|    value_loss           | 121         |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 579          |
|    ep_rew_mean          | -0.621       |
| time/                   |              |
|    fps                  | 621          |
|    iterations           | 4            |
|    time_elapsed         | 13           |
|    total_timesteps      | 8192         |
| train/                  |              |
|    approx_kl            | 0.0030828407 |
|    clip_fraction        | 0.00962      |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.07        |
|    explained_variance   | 0.324        |
|    learning_rate        | 0.0003       |
|    loss                 | 56.1         |
|    n_updates            | 30           |
|    policy_gradient_loss | -0.000248    |
|    value_loss           | 113          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 607          |
|    ep_rew_mean          | -0.627       |
| time/                   |              |
|    fps                  | 612          |
|    iterations           | 5            |
|    time_elapsed         | 16           |
|    total_timesteps      | 10240        |
| train/                  |              |
|    approx_kl            | 0.0038711438 |
|    clip_fraction        | 0.0209       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.05        |
|    explained_variance   | 0.182        |
|    learning_rate        | 0.0003       |
|    loss                 | 65.4         |
|    n_updates            | 40           |
|    policy_gradient_loss | 0.00116      |
|    value_loss           | 123          |
------------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 647        |
|    ep_rew_mean          | -0.483     |
| time/                   |            |
|    fps                  | 610        |
|    iterations           | 6          |
|    time_elapsed         | 20         |
|    total_timesteps      | 12288      |
| train/                  |            |
|    approx_kl            | 0.00891773 |
|    clip_fraction        | 0.117      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.02      |
|    explained_variance   | 0.495      |
|    learning_rate        | 0.0003     |
|    loss                 | 58.5       |
|    n_updates            | 50         |
|    policy_gradient_loss | -0.00234   |
|    value_loss           | 113        |
----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 656          |
|    ep_rew_mean          | -0.248       |
| time/                   |              |
|    fps                  | 606          |
|    iterations           | 7            |
|    time_elapsed         | 23           |
|    total_timesteps      | 14336        |
| train/                  |              |
|    approx_kl            | 0.0071707517 |
|    clip_fraction        | 0.111        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.01        |
|    explained_variance   | 0.412        |
|    learning_rate        | 0.0003       |
|    loss                 | 63           |
|    n_updates            | 60           |
|    policy_gradient_loss | -0.00576     |
|    value_loss           | 123          |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 674         |
|    ep_rew_mean          | -0.0739     |
| time/                   |             |
|    fps                  | 597         |
|    iterations           | 8           |
|    time_elapsed         | 27          |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.008988737 |
|    clip_fraction        | 0.112       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.984      |
|    explained_variance   | 0.329       |
|    learning_rate        | 0.0003      |
|    loss                 | 52          |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.00441    |
|    value_loss           | 111         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 660         |
|    ep_rew_mean          | -0.23       |
| time/                   |             |
|    fps                  | 595         |
|    iterations           | 9           |
|    time_elapsed         | 30          |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.008715453 |
|    clip_fraction        | 0.13        |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.03       |
|    explained_variance   | 0.084       |
|    learning_rate        | 0.0003      |
|    loss                 | 53          |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.00104    |
|    value_loss           | 107         |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 670          |
|    ep_rew_mean          | -0.0867      |
| time/                   |              |
|    fps                  | 592          |
|    iterations           | 10           |
|    time_elapsed         | 34           |
|    total_timesteps      | 20480        |
| train/                  |              |
|    approx_kl            | 0.0067700883 |
|    clip_fraction        | 0.122        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.03        |
|    explained_variance   | 0.269        |
|    learning_rate        | 0.0003       |
|    loss                 | 54.5         |
|    n_updates            | 90           |
|    policy_gradient_loss | -0.0022      |
|    value_loss           | 119          |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 649         |
|    ep_rew_mean          | -0.0971     |
| time/                   |             |
|    fps                  | 590         |
|    iterations           | 11          |
|    time_elapsed         | 38          |
|    total_timesteps      | 22528       |
| train/                  |             |
|    approx_kl            | 0.010573771 |
|    clip_fraction        | 0.157       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.985      |
|    explained_variance   | -0.012      |
|    learning_rate        | 0.0003      |
|    loss                 | 53.6        |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.00309    |
|    value_loss           | 105         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 656         |
|    ep_rew_mean          | -0.235      |
| time/                   |             |
|    fps                  | 565         |
|    iterations           | 12          |
|    time_elapsed         | 43          |
|    total_timesteps      | 24576       |
| train/                  |             |
|    approx_kl            | 0.009836816 |
|    clip_fraction        | 0.106       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.973      |
|    explained_variance   | 0.147       |
|    learning_rate        | 0.0003      |
|    loss                 | 56.7        |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.003      |
|    value_loss           | 116         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 652         |
|    ep_rew_mean          | -0.405      |
| time/                   |             |
|    fps                  | 549         |
|    iterations           | 13          |
|    time_elapsed         | 48          |
|    total_timesteps      | 26624       |
| train/                  |             |
|    approx_kl            | 0.009737739 |
|    clip_fraction        | 0.136       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.963      |
|    explained_variance   | 0.432       |
|    learning_rate        | 0.0003      |
|    loss                 | 52.4        |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.00719    |
|    value_loss           | 114         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 656         |
|    ep_rew_mean          | -0.481      |
| time/                   |             |
|    fps                  | 548         |
|    iterations           | 14          |
|    time_elapsed         | 52          |
|    total_timesteps      | 28672       |
| train/                  |             |
|    approx_kl            | 0.009574281 |
|    clip_fraction        | 0.0736      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.05       |
|    explained_variance   | 0.298       |
|    learning_rate        | 0.0003      |
|    loss                 | 55.4        |
|    n_updates            | 130         |
|    policy_gradient_loss | -5.85e-05   |
|    value_loss           | 109         |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 663          |
|    ep_rew_mean          | -0.546       |
| time/                   |              |
|    fps                  | 543          |
|    iterations           | 15           |
|    time_elapsed         | 56           |
|    total_timesteps      | 30720        |
| train/                  |              |
|    approx_kl            | 0.0074083675 |
|    clip_fraction        | 0.127        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.03        |
|    explained_variance   | 0.449        |
|    learning_rate        | 0.0003       |
|    loss                 | 53.4         |
|    n_updates            | 140          |
|    policy_gradient_loss | -0.00361     |
|    value_loss           | 112          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 655          |
|    ep_rew_mean          | -0.494       |
| time/                   |              |
|    fps                  | 541          |
|    iterations           | 16           |
|    time_elapsed         | 60           |
|    total_timesteps      | 32768        |
| train/                  |              |
|    approx_kl            | 0.0135722235 |
|    clip_fraction        | 0.108        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.06        |
|    explained_variance   | 0.432        |
|    learning_rate        | 0.0003       |
|    loss                 | 59.4         |
|    n_updates            | 150          |
|    policy_gradient_loss | -0.00136     |
|    value_loss           | 114          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 640          |
|    ep_rew_mean          | -0.359       |
| time/                   |              |
|    fps                  | 542          |
|    iterations           | 17           |
|    time_elapsed         | 64           |
|    total_timesteps      | 34816        |
| train/                  |              |
|    approx_kl            | 0.0065480545 |
|    clip_fraction        | 0.0705       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.07        |
|    explained_variance   | 0.269        |
|    learning_rate        | 0.0003       |
|    loss                 | 54           |
|    n_updates            | 160          |
|    policy_gradient_loss | -0.00012     |
|    value_loss           | 112          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 643          |
|    ep_rew_mean          | -0.384       |
| time/                   |              |
|    fps                  | 541          |
|    iterations           | 18           |
|    time_elapsed         | 68           |
|    total_timesteps      | 36864        |
| train/                  |              |
|    approx_kl            | 0.0061988737 |
|    clip_fraction        | 0.0124       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.01        |
|    explained_variance   | 0.368        |
|    learning_rate        | 0.0003       |
|    loss                 | 60.2         |
|    n_updates            | 170          |
|    policy_gradient_loss | -0.000475    |
|    value_loss           | 119          |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 642         |
|    ep_rew_mean          | -0.458      |
| time/                   |             |
|    fps                  | 542         |
|    iterations           | 19          |
|    time_elapsed         | 71          |
|    total_timesteps      | 38912       |
| train/                  |             |
|    approx_kl            | 0.012251501 |
|    clip_fraction        | 0.146       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.05       |
|    explained_variance   | 0.331       |
|    learning_rate        | 0.0003      |
|    loss                 | 54          |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.0045     |
|    value_loss           | 112         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 630         |
|    ep_rew_mean          | -0.497      |
| time/                   |             |
|    fps                  | 542         |
|    iterations           | 20          |
|    time_elapsed         | 75          |
|    total_timesteps      | 40960       |
| train/                  |             |
|    approx_kl            | 0.004851218 |
|    clip_fraction        | 0.0834      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.08       |
|    explained_variance   | 0.394       |
|    learning_rate        | 0.0003      |
|    loss                 | 87.8        |
|    n_updates            | 190         |
|    policy_gradient_loss | 0.00233     |
|    value_loss           | 179         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 620         |
|    ep_rew_mean          | -0.481      |
| time/                   |             |
|    fps                  | 541         |
|    iterations           | 21          |
|    time_elapsed         | 79          |
|    total_timesteps      | 43008       |
| train/                  |             |
|    approx_kl            | 0.008644781 |
|    clip_fraction        | 0.0894      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.05       |
|    explained_variance   | 0.19        |
|    learning_rate        | 0.0003      |
|    loss                 | 90          |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.00231    |
|    value_loss           | 179         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 608         |
|    ep_rew_mean          | -0.467      |
| time/                   |             |
|    fps                  | 543         |
|    iterations           | 22          |
|    time_elapsed         | 82          |
|    total_timesteps      | 45056       |
| train/                  |             |
|    approx_kl            | 0.007524896 |
|    clip_fraction        | 0.118       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.05       |
|    explained_variance   | 0.357       |
|    learning_rate        | 0.0003      |
|    loss                 | 91.3        |
|    n_updates            | 210         |
|    policy_gradient_loss | 0.00187     |
|    value_loss           | 195         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 609         |
|    ep_rew_mean          | -0.464      |
| time/                   |             |
|    fps                  | 541         |
|    iterations           | 23          |
|    time_elapsed         | 86          |
|    total_timesteps      | 47104       |
| train/                  |             |
|    approx_kl            | 0.006898882 |
|    clip_fraction        | 0.0484      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.04       |
|    explained_variance   | 0.219       |
|    learning_rate        | 0.0003      |
|    loss                 | 92.4        |
|    n_updates            | 220         |
|    policy_gradient_loss | 0.000367    |
|    value_loss           | 188         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 604         |
|    ep_rew_mean          | -0.452      |
| time/                   |             |
|    fps                  | 541         |
|    iterations           | 24          |
|    time_elapsed         | 90          |
|    total_timesteps      | 49152       |
| train/                  |             |
|    approx_kl            | 0.010043703 |
|    clip_fraction        | 0.114       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.03       |
|    explained_variance   | 0.375       |
|    learning_rate        | 0.0003      |
|    loss                 | 93.2        |
|    n_updates            | 230         |
|    policy_gradient_loss | -0.000408   |
|    value_loss           | 193         |
-----------------------------------------
Traceback (most recent call last):
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/pong/run_supervised.py", line 24, in <module>
    model.learn(total_timesteps=100000, callback=WandbCallback())
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 313, in learn
    self.train()
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 281, in train
    th.nn.utils.clip_grad_norm_(self.policy.parameters(), self.max_grad_norm)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/utils/clip_grad.py", line 20, in _no_grad_wrapper
    return func(*args, **kwargs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/utils/clip_grad.py", line 67, in clip_grad_norm_
    norms.extend(torch._foreach_norm(device_grads, norm_type))
KeyboardInterrupt