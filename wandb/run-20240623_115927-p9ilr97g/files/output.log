Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
-----------------------------
| time/              |      |
|    fps             | 315  |
|    iterations      | 1    |
|    time_elapsed    | 6    |
|    total_timesteps | 2048 |
-----------------------------
Time to encode: 0.07027888298034668
Time to encode: 0.06924700736999512
Time to encode: 0.18297219276428223
Time to encode: 0.06561708450317383
Time to encode: 0.06954431533813477
Time to encode: 0.06496620178222656
Time to encode: 0.06687283515930176
Time to encode: 0.06719613075256348
Time to encode: 0.06818890571594238
Time to encode: 0.0665898323059082
Time to encode: 0.0669548511505127
Time to encode: 0.0697011947631836
Time to encode: 0.0678410530090332
Time to encode: 0.06696701049804688
Time to encode: 0.06890606880187988
Time to encode: 0.06838226318359375
Time to encode: 0.06535673141479492
Time to encode: 0.06934499740600586
Time to encode: 0.1456737518310547
Time to encode: 0.06575894355773926
Time to encode: 0.06806492805480957
Time to encode: 0.06795525550842285
Time to encode: 0.06838393211364746
Time to encode: 0.06490302085876465
Time to encode: 0.06995892524719238
Time to encode: 0.06930994987487793
Time to encode: 0.06929802894592285
Time to encode: 0.06969904899597168
Time to encode: 0.06856012344360352
Time to encode: 0.06860589981079102
Time to encode: 0.0690770149230957
Time to encode: 0.06436014175415039
Time to encode: 0.06506991386413574
Time to encode: 0.14481306076049805
Time to encode: 0.07115888595581055
Time to encode: 0.07012772560119629
Time to encode: 0.06679511070251465
Time to encode: 0.06695818901062012
Time to encode: 0.0685429573059082
Time to encode: 0.06700992584228516
Time to encode: 0.06934285163879395
Time to encode: 0.0638270378112793
Time to encode: 0.06663298606872559
Time to encode: 0.06731104850769043
Time to encode: 0.06780099868774414
Time to encode: 0.06578874588012695
Time to encode: 0.06457996368408203
Time to encode: 0.06981182098388672
Time to encode: 0.0663611888885498
Time to encode: 0.06512093544006348
Time to encode: 0.14473986625671387
Time to encode: 0.06772899627685547
Time to encode: 0.06590700149536133
Time to encode: 0.06924700736999512
Time to encode: 0.06725907325744629
Time to encode: 0.06643033027648926
Time to encode: 0.06513094902038574
Time to encode: 0.0678873062133789
Time to encode: 0.06698489189147949
Time to encode: 0.0690927505493164
Time to encode: 0.06797218322753906
Time to encode: 0.0666348934173584
Time to encode: 0.06709718704223633
Time to encode: 0.06925606727600098
Time to encode: 0.06902599334716797
Time to encode: 0.06477999687194824
Time to encode: 0.06728219985961914
Time to encode: 0.06851696968078613
Time to encode: 0.06815600395202637
Time to encode: 0.15932512283325195
Time to encode: 0.0708620548248291
Time to encode: 0.07024884223937988
Time to encode: 0.07041096687316895
Time to encode: 0.06734681129455566
Time to encode: 0.06549191474914551
Time to encode: 0.06868720054626465
Time to encode: 0.06886601448059082
Time to encode: 0.06505298614501953
Time to encode: 0.06721615791320801
Time to encode: 0.06635117530822754
Time to encode: 0.06750893592834473
Time to encode: 0.0683290958404541
Time to encode: 0.06816887855529785
Time to encode: 0.0720210075378418
Time to encode: 0.07158088684082031
Time to encode: 0.06730771064758301
Time to encode: 0.06948304176330566
Time to encode: 0.16430306434631348
Time to encode: 0.0651845932006836
Time to encode: 0.06931877136230469
Time to encode: 0.0690608024597168
Time to encode: 0.06592631340026855
Time to encode: 0.06835103034973145
Time to encode: 0.06892895698547363
Time to encode: 0.06650614738464355
Time to encode: 0.07011699676513672
Time to encode: 0.06713199615478516
Time to encode: 0.06639695167541504
Time to encode: 0.06460690498352051
Time to encode: 0.06948709487915039
Time to encode: 0.0692288875579834
Time to encode: 0.06952285766601562
Time to encode: 0.06730389595031738
Time to encode: 0.06893110275268555
Time to encode: 0.06694889068603516
Time to encode: 0.0706629753112793
Time to encode: 0.16185760498046875
Time to encode: 0.07029175758361816
Time to encode: 0.0679311752319336
Time to encode: 0.06833505630493164
Time to encode: 0.06859207153320312
Time to encode: 0.06742024421691895
Time to encode: 0.0688018798828125
Time to encode: 0.0686798095703125
Time to encode: 0.0655059814453125
Time to encode: 0.06867218017578125
Time to encode: 0.06848692893981934
Time to encode: 0.06917905807495117
Time to encode: 0.0681908130645752
Time to encode: 0.06808876991271973
Time to encode: 0.06743597984313965
Time to encode: 0.06651186943054199
Time to encode: 0.15217995643615723
Time to encode: 0.0671529769897461
Time to encode: 0.06599235534667969
Time to encode: 0.06915616989135742
Time to encode: 0.06929588317871094
Time to encode: 0.06904387474060059
Time to encode: 0.07036185264587402
Time to encode: 0.0677328109741211
Time to encode: 0.06780004501342773
Time to encode: 0.06731486320495605
Time to encode: 0.07131290435791016
Time to encode: 0.06599593162536621
Time to encode: 0.07098698616027832
Time to encode: 0.06723403930664062
Time to encode: 0.06547784805297852
Time to encode: 0.06989622116088867
Time to encode: 0.06678199768066406
Time to encode: 0.06847214698791504
Time to encode: 0.06627988815307617
Time to encode: 0.06795525550842285
Time to encode: 0.06664204597473145
Time to encode: 0.15372920036315918
Time to encode: 0.06709885597229004
Time to encode: 0.06401896476745605
Time to encode: 0.0691990852355957
Time to encode: 0.0646209716796875
Time to encode: 0.06779217720031738
Time to encode: 0.06696605682373047
Time to encode: 0.06527304649353027
Time to encode: 0.06636810302734375
Time to encode: 0.06815886497497559
Time to encode: 0.06730389595031738
Time to encode: 0.06442499160766602
Time to encode: 0.06395626068115234
Time to encode: 0.06747913360595703
Time to encode: 0.06772804260253906
Time to encode: 0.06794977188110352
Time to encode: 0.06542491912841797
Time to encode: 0.06857609748840332
Time to encode: 0.15865707397460938
Time to encode: 0.06822085380554199
Time to encode: 0.06515192985534668
Time to encode: 0.06478095054626465
Time to encode: 0.06902623176574707
Time to encode: 0.06928896903991699
Time to encode: 0.0706329345703125
Time to encode: 0.0655832290649414
Time to encode: 0.0701451301574707
Time to encode: 0.0686042308807373
Time to encode: 0.0680232048034668
Time to encode: 0.06770181655883789
Time to encode: 0.0678091049194336
Time to encode: 0.06689691543579102
Time to encode: 0.06580805778503418
Time to encode: 0.06677818298339844
Time to encode: 0.15540122985839844
Time to encode: 0.06894683837890625
Time to encode: 0.06936192512512207
Time to encode: 0.06731891632080078
Time to encode: 0.06888008117675781
Time to encode: 0.07415390014648438
Time to encode: 0.07032275199890137
Time to encode: 0.06644415855407715
Time to encode: 0.0680689811706543
Time to encode: 0.06534719467163086
Time to encode: 0.0648050308227539
Time to encode: 0.06594300270080566
Time to encode: 0.06732296943664551
Time to encode: 0.06854677200317383
Time to encode: 0.06790494918823242
Time to encode: 0.1463921070098877
Time to encode: 0.06553292274475098
Time to encode: 0.06629610061645508
Time to encode: 0.06702804565429688
Time to encode: 0.06677007675170898
Time to encode: 0.06667113304138184
Time to encode: 0.06772398948669434
Time to encode: 0.06790995597839355
Time to encode: 0.06711697578430176
Time to encode: 0.06820988655090332
Time to encode: 0.06452298164367676
Time to encode: 0.06671285629272461
Time to encode: 0.06883597373962402
Time to encode: 0.06569600105285645
Time to encode: 0.06866717338562012
Time to encode: 0.06567597389221191
Time to encode: 0.0698699951171875
Time to encode: 0.06841373443603516
Time to encode: 0.06863617897033691
Time to encode: 0.06949424743652344
Time to encode: 0.06822013854980469
Time to encode: 0.15574407577514648
Time to encode: 0.06769776344299316
Time to encode: 0.06587600708007812
Time to encode: 0.06752634048461914
Time to encode: 0.06905293464660645
Time to encode: 0.0659480094909668
Time to encode: 0.06609916687011719
Time to encode: 0.07063078880310059
Time to encode: 0.065582275390625
Time to encode: 0.064849853515625
Time to encode: 0.0679788589477539
Time to encode: 0.067626953125
Time to encode: 0.06641626358032227
Time to encode: 0.06858277320861816
Time to encode: 0.06745672225952148
Time to encode: 0.06875181198120117
Time to encode: 0.06950879096984863
Time to encode: 0.0681312084197998
Time to encode: 0.1660139560699463
Time to encode: 0.07434582710266113
Time to encode: 0.07191610336303711
Time to encode: 0.06927680969238281
Time to encode: 0.06949377059936523
Time to encode: 0.0681610107421875
Time to encode: 0.0692141056060791
Time to encode: 0.06765222549438477
Time to encode: 0.06387209892272949
Time to encode: 0.07023191452026367
Time to encode: 0.0650641918182373
Time to encode: 0.0675668716430664
Time to encode: 0.06637310981750488
Time to encode: 0.0693666934967041
Time to encode: 0.06701421737670898
Time to encode: 0.0678718090057373
Time to encode: 0.1593468189239502
Time to encode: 0.06607389450073242
Time to encode: 0.06744599342346191
Time to encode: 0.06911396980285645
Time to encode: 0.06585001945495605
Time to encode: 0.06819462776184082
Time to encode: 0.06830835342407227
Time to encode: 0.068817138671875
Time to encode: 0.06465983390808105
Time to encode: 0.06590890884399414
Time to encode: 0.07034182548522949
Time to encode: 0.07052278518676758
Time to encode: 0.06801509857177734
Time to encode: 0.06502699851989746
Time to encode: 0.06669998168945312
Time to encode: 0.06890082359313965
Time to encode: 0.06924819946289062
Time to encode: 0.15306901931762695
Time to encode: 0.06863284111022949
Time to encode: 0.06919503211975098
Time to encode: 0.06727409362792969
Time to encode: 0.06901717185974121
Time to encode: 0.06832718849182129
Time to encode: 0.06804990768432617
Time to encode: 0.06749606132507324
Time to encode: 0.06897783279418945
Time to encode: 0.06995892524719238
Time to encode: 0.06837201118469238
Time to encode: 0.06981682777404785
Time to encode: 0.0679619312286377
Time to encode: 0.06859493255615234
Time to encode: 0.06978917121887207
Time to encode: 0.06630778312683105
Time to encode: 0.06610608100891113
Time to encode: 0.06956815719604492
Time to encode: 0.07052373886108398
Time to encode: 0.1570899486541748
Time to encode: 0.06554102897644043
Time to encode: 0.06538891792297363
Time to encode: 0.06714606285095215
Time to encode: 0.06806015968322754
Time to encode: 0.06878972053527832
Time to encode: 0.06667399406433105
Time to encode: 0.06605792045593262
Time to encode: 0.06726503372192383
Time to encode: 0.0690770149230957
Time to encode: 0.06841492652893066
Time to encode: 0.06705307960510254
Time to encode: 0.06850385665893555
Time to encode: 0.06740212440490723
Time to encode: 0.06895613670349121
Time to encode: 0.06947684288024902
Time to encode: 0.06448793411254883
Time to encode: 0.0684669017791748
Time to encode: 0.15038394927978516
Time to encode: 0.06650495529174805
Time to encode: 0.0661170482635498
Time to encode: 0.06621408462524414
Time to encode: 0.06480979919433594
Time to encode: 0.06699967384338379
Time to encode: 0.07266688346862793
Time to encode: 0.06747102737426758
Time to encode: 0.06906604766845703
Time to encode: 0.06795716285705566
Time to encode: 0.06675314903259277
Time to encode: 0.06852316856384277
Time to encode: 0.06628704071044922
Time to encode: 0.0693058967590332
Time to encode: 0.06526398658752441
Time to encode: 0.06908702850341797
Time to encode: 0.0668940544128418
Time to encode: 0.06589794158935547
Time to encode: 0.06698203086853027
Traceback (most recent call last):
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/freeway/run_supervised_gnn.py", line 47, in <module>
    model.learn(total_timesteps=1000000, callback=WandbCallback())
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 300, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 179, in collect_rollouts
    actions, values, log_probs = self.policy(obs_tensor)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 645, in forward
    features = self.extract_features(obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 672, in extract_features
    return super().extract_features(obs, self.features_extractor if features_extractor is None else features_extractor)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 131, in extract_features
    return features_extractor(preprocessed_obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/model/policy.py", line 40, in forward
    pyg_data = self.encoder.encode(observations)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/encoder/GraphEncoder.py", line 141, in encode
    if abs(node_features[i, 1] - node_features[j, 1]) <= proximity_threshold:
KeyboardInterrupt