Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
-----------------------------
| time/              |      |
|    fps             | 303  |
|    iterations      | 1    |
|    time_elapsed    | 6    |
|    total_timesteps | 2048 |
-----------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 120          |
|    iterations           | 2            |
|    time_elapsed         | 34           |
|    total_timesteps      | 4096         |
| train/                  |              |
|    approx_kl            | 0.0112910075 |
|    clip_fraction        | 0.117        |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.09        |
|    explained_variance   | -1.1         |
|    learning_rate        | 0.0003       |
|    loss                 | -0.014       |
|    n_updates            | 10           |
|    policy_gradient_loss | -0.00724     |
|    value_loss           | 0.0119       |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.41e+03     |
|    ep_rew_mean          | 267          |
| time/                   |              |
|    fps                  | 98           |
|    iterations           | 3            |
|    time_elapsed         | 62           |
|    total_timesteps      | 6144         |
| train/                  |              |
|    approx_kl            | 0.0028218455 |
|    clip_fraction        | 0.00142      |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.08        |
|    explained_variance   | 0.00468      |
|    learning_rate        | 0.0003       |
|    loss                 | 24.7         |
|    n_updates            | 20           |
|    policy_gradient_loss | 0.000478     |
|    value_loss           | 31.7         |
------------------------------------------
-------------------------------------------
| rollout/                |               |
|    ep_len_mean          | 5.41e+03      |
|    ep_rew_mean          | 267           |
| time/                   |               |
|    fps                  | 91            |
|    iterations           | 4             |
|    time_elapsed         | 89            |
|    total_timesteps      | 8192          |
| train/                  |               |
|    approx_kl            | 0.00045151918 |
|    clip_fraction        | 0.00195       |
|    clip_range           | 0.2           |
|    entropy_loss         | -1.08         |
|    explained_variance   | 0.14          |
|    learning_rate        | 0.0003        |
|    loss                 | 32.6          |
|    n_updates            | 30            |
|    policy_gradient_loss | 0.00146       |
|    value_loss           | 105           |
-------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.41e+03     |
|    ep_rew_mean          | 267          |
| time/                   |              |
|    fps                  | 86           |
|    iterations           | 5            |
|    time_elapsed         | 117          |
|    total_timesteps      | 10240        |
| train/                  |              |
|    approx_kl            | 0.0007676579 |
|    clip_fraction        | 9.77e-05     |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.08        |
|    explained_variance   | 0.425        |
|    learning_rate        | 0.0003       |
|    loss                 | 94.7         |
|    n_updates            | 40           |
|    policy_gradient_loss | -0.000824    |
|    value_loss           | 123          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.12e+03     |
|    ep_rew_mean          | 669          |
| time/                   |              |
|    fps                  | 84           |
|    iterations           | 6            |
|    time_elapsed         | 145          |
|    total_timesteps      | 12288        |
| train/                  |              |
|    approx_kl            | 0.0016639871 |
|    clip_fraction        | 4.88e-05     |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.07        |
|    explained_variance   | 0.487        |
|    learning_rate        | 0.0003       |
|    loss                 | 21.8         |
|    n_updates            | 50           |
|    policy_gradient_loss | -0.00248     |
|    value_loss           | 93.2         |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.12e+03     |
|    ep_rew_mean          | 669          |
| time/                   |              |
|    fps                  | 82           |
|    iterations           | 7            |
|    time_elapsed         | 174          |
|    total_timesteps      | 14336        |
| train/                  |              |
|    approx_kl            | 0.0033391407 |
|    clip_fraction        | 0.00322      |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.06        |
|    explained_variance   | 0.562        |
|    learning_rate        | 0.0003       |
|    loss                 | 123          |
|    n_updates            | 60           |
|    policy_gradient_loss | -0.00511     |
|    value_loss           | 212          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.2e+03      |
|    ep_rew_mean          | 1.57e+03     |
| time/                   |              |
|    fps                  | 81           |
|    iterations           | 8            |
|    time_elapsed         | 202          |
|    total_timesteps      | 16384        |
| train/                  |              |
|    approx_kl            | 0.0095979385 |
|    clip_fraction        | 0.0212       |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.03        |
|    explained_variance   | 0.653        |
|    learning_rate        | 0.0003       |
|    loss                 | 82.4         |
|    n_updates            | 70           |
|    policy_gradient_loss | -0.00799     |
|    value_loss           | 194          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.2e+03      |
|    ep_rew_mean          | 1.57e+03     |
| time/                   |              |
|    fps                  | 80           |
|    iterations           | 9            |
|    time_elapsed         | 230          |
|    total_timesteps      | 18432        |
| train/                  |              |
|    approx_kl            | 0.0041465377 |
|    clip_fraction        | 0.00146      |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.99        |
|    explained_variance   | 0.653        |
|    learning_rate        | 0.0003       |
|    loss                 | 154          |
|    n_updates            | 80           |
|    policy_gradient_loss | -0.00378     |
|    value_loss           | 238          |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 5.2e+03     |
|    ep_rew_mean          | 1.57e+03    |
| time/                   |             |
|    fps                  | 79          |
|    iterations           | 10          |
|    time_elapsed         | 257         |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.007958602 |
|    clip_fraction        | 0.0251      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.939      |
|    explained_variance   | 0.664       |
|    learning_rate        | 0.0003      |
|    loss                 | 129         |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.00875    |
|    value_loss           | 341         |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.12e+03     |
|    ep_rew_mean          | 2.54e+03     |
| time/                   |              |
|    fps                  | 78           |
|    iterations           | 11           |
|    time_elapsed         | 285          |
|    total_timesteps      | 22528        |
| train/                  |              |
|    approx_kl            | 0.0048364284 |
|    clip_fraction        | 0.000635     |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.882       |
|    explained_variance   | 0.646        |
|    learning_rate        | 0.0003       |
|    loss                 | 176          |
|    n_updates            | 100          |
|    policy_gradient_loss | -0.00502     |
|    value_loss           | 419          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.12e+03     |
|    ep_rew_mean          | 2.54e+03     |
| time/                   |              |
|    fps                  | 78           |
|    iterations           | 12           |
|    time_elapsed         | 313          |
|    total_timesteps      | 24576        |
| train/                  |              |
|    approx_kl            | 0.0065929405 |
|    clip_fraction        | 0.0396       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.842       |
|    explained_variance   | 0.569        |
|    learning_rate        | 0.0003       |
|    loss                 | 152          |
|    n_updates            | 110          |
|    policy_gradient_loss | -0.0059      |
|    value_loss           | 438          |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 5.18e+03     |
|    ep_rew_mean          | 3.59e+03     |
| time/                   |              |
|    fps                  | 77           |
|    iterations           | 13           |
|    time_elapsed         | 341          |
|    total_timesteps      | 26624        |
| train/                  |              |
|    approx_kl            | 0.0029468716 |
|    clip_fraction        | 0.00459      |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.8         |
|    explained_variance   | 0.52         |
|    learning_rate        | 0.0003       |
|    loss                 | 511          |
|    n_updates            | 120          |
|    policy_gradient_loss | -0.00326     |
|    value_loss           | 618          |
------------------------------------------
Traceback (most recent call last):
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/freeway/run_supervised_gnn.py", line 47, in <module>
    model.learn(total_timesteps=1000000, callback=WandbCallback())
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 313, in learn
    self.train()
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 217, in train
    values, log_prob, entropy = self.policy.evaluate_actions(rollout_data.observations, actions)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 730, in evaluate_actions
    features = self.extract_features(obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 672, in extract_features
    return super().extract_features(obs, self.features_extractor if features_extractor is None else features_extractor)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 131, in extract_features
    return features_extractor(preprocessed_obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/model/policy.py", line 40, in forward
    pyg_data = self.encoder.encode(observations)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/encoder/GraphEncoder.py", line 147, in encode
    graph.add_edge(j, atom_index, position=1)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/networkx/classes/graph.py", line 962, in add_edge
    datadict = self._adj[u].get(v, self.edge_attr_dict_factory())
KeyboardInterrupt