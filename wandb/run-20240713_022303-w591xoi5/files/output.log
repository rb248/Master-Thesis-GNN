Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
-----------------------------
| time/              |      |
|    fps             | 230  |
|    iterations      | 1    |
|    time_elapsed    | 8    |
|    total_timesteps | 2048 |
-----------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 68          |
|    iterations           | 2           |
|    time_elapsed         | 59          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.004981629 |
|    clip_fraction        | 0.0466      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.09       |
|    explained_variance   | -0.0136     |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0133      |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.000429   |
|    value_loss           | 6.46        |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 3e+03        |
|    ep_rew_mean          | -1.5e+03     |
| time/                   |              |
|    fps                  | 55           |
|    iterations           | 3            |
|    time_elapsed         | 111          |
|    total_timesteps      | 6144         |
| train/                  |              |
|    approx_kl            | 0.0001499971 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -1.09        |
|    explained_variance   | 1.13e-06     |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0332       |
|    n_updates            | 20           |
|    policy_gradient_loss | -4.73e-05    |
|    value_loss           | 14.6         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 50          |
|    iterations           | 4           |
|    time_elapsed         | 161         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.005134436 |
|    clip_fraction        | 0.00313     |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.1        |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.184       |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.000742   |
|    value_loss           | 10.9        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 46          |
|    iterations           | 5           |
|    time_elapsed         | 218         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.010032626 |
|    clip_fraction        | 0.0404      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.1        |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0473      |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.00222    |
|    value_loss           | 5.93        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 45          |
|    iterations           | 6           |
|    time_elapsed         | 272         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.007430722 |
|    clip_fraction        | 0.0258      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.09       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0153      |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.00169    |
|    value_loss           | 6.64        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 44          |
|    iterations           | 7           |
|    time_elapsed         | 320         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.008015506 |
|    clip_fraction        | 0.0363      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.08       |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 0.133       |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.000878   |
|    value_loss           | 6.22        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 43          |
|    iterations           | 8           |
|    time_elapsed         | 378         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.013449449 |
|    clip_fraction        | 0.0539      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.07       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00668     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.00148    |
|    value_loss           | 1.36        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 42          |
|    iterations           | 9           |
|    time_elapsed         | 432         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.009144561 |
|    clip_fraction        | 0.0492      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.04       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0372      |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.00169    |
|    value_loss           | 6.46        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 42          |
|    iterations           | 10          |
|    time_elapsed         | 485         |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.006146342 |
|    clip_fraction        | 0.00371     |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.993      |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 1.43        |
|    n_updates            | 90          |
|    policy_gradient_loss | -3.22e-05   |
|    value_loss           | 6.8         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 42          |
|    iterations           | 11          |
|    time_elapsed         | 534         |
|    total_timesteps      | 22528       |
| train/                  |             |
|    approx_kl            | 0.013907734 |
|    clip_fraction        | 0.102       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.912      |
|    explained_variance   | 5.96e-08    |
|    learning_rate        | 0.0003      |
|    loss                 | 0.014       |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.000686   |
|    value_loss           | 0.339       |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 3e+03        |
|    ep_rew_mean          | -1.5e+03     |
| time/                   |              |
|    fps                  | 41           |
|    iterations           | 12           |
|    time_elapsed         | 590          |
|    total_timesteps      | 24576        |
| train/                  |              |
|    approx_kl            | 0.0017600405 |
|    clip_fraction        | 0.00742      |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.905       |
|    explained_variance   | 0            |
|    learning_rate        | 0.0003       |
|    loss                 | 0.663        |
|    n_updates            | 110          |
|    policy_gradient_loss | 0.000369     |
|    value_loss           | 7.57         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 41          |
|    iterations           | 13          |
|    time_elapsed         | 644         |
|    total_timesteps      | 26624       |
| train/                  |             |
|    approx_kl            | 0.012385298 |
|    clip_fraction        | 0.0363      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.853      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.603       |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.000429   |
|    value_loss           | 7.89        |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 3e+03     |
|    ep_rew_mean          | -1.5e+03  |
| time/                   |           |
|    fps                  | 41        |
|    iterations           | 14        |
|    time_elapsed         | 698       |
|    total_timesteps      | 28672     |
| train/                  |           |
|    approx_kl            | 0.0063506 |
|    clip_fraction        | 0.0444    |
|    clip_range           | 0.2       |
|    entropy_loss         | -0.798    |
|    explained_variance   | 1.19e-07  |
|    learning_rate        | 0.0003    |
|    loss                 | -0.00315  |
|    n_updates            | 130       |
|    policy_gradient_loss | -0.000736 |
|    value_loss           | 0.0914    |
---------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 3e+03        |
|    ep_rew_mean          | -1.5e+03     |
| time/                   |              |
|    fps                  | 40           |
|    iterations           | 15           |
|    time_elapsed         | 749          |
|    total_timesteps      | 30720        |
| train/                  |              |
|    approx_kl            | 0.0061890613 |
|    clip_fraction        | 0.0501       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.839       |
|    explained_variance   | -3.58e-07    |
|    learning_rate        | 0.0003       |
|    loss                 | 5.84         |
|    n_updates            | 140          |
|    policy_gradient_loss | -0.00263     |
|    value_loss           | 8.45         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 41          |
|    iterations           | 16          |
|    time_elapsed         | 798         |
|    total_timesteps      | 32768       |
| train/                  |             |
|    approx_kl            | 0.010718906 |
|    clip_fraction        | 0.0992      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.775      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 8.74        |
|    n_updates            | 150         |
|    policy_gradient_loss | -0.00156    |
|    value_loss           | 8.63        |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 3e+03        |
|    ep_rew_mean          | -1.5e+03     |
| time/                   |              |
|    fps                  | 41           |
|    iterations           | 17           |
|    time_elapsed         | 848          |
|    total_timesteps      | 34816        |
| train/                  |              |
|    approx_kl            | 0.0010615354 |
|    clip_fraction        | 0.0184       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.761       |
|    explained_variance   | 0            |
|    learning_rate        | 0.0003       |
|    loss                 | -0.000141    |
|    n_updates            | 160          |
|    policy_gradient_loss | -0.00771     |
|    value_loss           | 0.0333       |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 3e+03        |
|    ep_rew_mean          | -1.5e+03     |
| time/                   |              |
|    fps                  | 41           |
|    iterations           | 18           |
|    time_elapsed         | 898          |
|    total_timesteps      | 36864        |
| train/                  |              |
|    approx_kl            | 0.0005444719 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.732       |
|    explained_variance   | -4.77e-07    |
|    learning_rate        | 0.0003       |
|    loss                 | 9.35         |
|    n_updates            | 170          |
|    policy_gradient_loss | 0.000107     |
|    value_loss           | 9.02         |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 41          |
|    iterations           | 19          |
|    time_elapsed         | 947         |
|    total_timesteps      | 38912       |
| train/                  |             |
|    approx_kl            | 0.004604444 |
|    clip_fraction        | 0.0602      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.75       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0167      |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.00292    |
|    value_loss           | 9.12        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 40          |
|    iterations           | 20          |
|    time_elapsed         | 1002        |
|    total_timesteps      | 40960       |
| train/                  |             |
|    approx_kl            | 0.006889665 |
|    clip_fraction        | 0.0468      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.697      |
|    explained_variance   | 5.96e-08    |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0134     |
|    n_updates            | 190         |
|    policy_gradient_loss | 0.000653    |
|    value_loss           | 0.0124      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 40          |
|    iterations           | 21          |
|    time_elapsed         | 1053        |
|    total_timesteps      | 43008       |
| train/                  |             |
|    approx_kl            | 0.006490142 |
|    clip_fraction        | 0.0759      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.603      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 1.32        |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.00118    |
|    value_loss           | 9.38        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 3e+03       |
|    ep_rew_mean          | -1.5e+03    |
| time/                   |             |
|    fps                  | 40          |
|    iterations           | 22          |
|    time_elapsed         | 1103        |
|    total_timesteps      | 45056       |
| train/                  |             |
|    approx_kl            | 0.004770139 |
|    clip_fraction        | 0.07        |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.524      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 0.152       |
|    n_updates            | 210         |
|    policy_gradient_loss | -0.00122    |
|    value_loss           | 9.45        |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 3e+03        |
|    ep_rew_mean          | -1.5e+03     |
| time/                   |              |
|    fps                  | 40           |
|    iterations           | 23           |
|    time_elapsed         | 1155         |
|    total_timesteps      | 47104        |
| train/                  |              |
|    approx_kl            | 0.0047065048 |
|    clip_fraction        | 0.0649       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.437       |
|    explained_variance   | -1.19e-07    |
|    learning_rate        | 0.0003       |
|    loss                 | 5.13         |
|    n_updates            | 220          |
|    policy_gradient_loss | -0.0024      |
|    value_loss           | 9.49         |
------------------------------------------
-------------------------------------------
| rollout/                |               |
|    ep_len_mean          | 3e+03         |
|    ep_rew_mean          | -1.5e+03      |
| time/                   |               |
|    fps                  | 40            |
|    iterations           | 24            |
|    time_elapsed         | 1207          |
|    total_timesteps      | 49152         |
| train/                  |               |
|    approx_kl            | 0.00072487793 |
|    clip_fraction        | 0.042         |
|    clip_range           | 0.2           |
|    entropy_loss         | -0.384        |
|    explained_variance   | 0             |
|    learning_rate        | 0.0003        |
|    loss                 | -0.000758     |
|    n_updates            | 230           |
|    policy_gradient_loss | -0.000487     |
|    value_loss           | 0.00585       |
-------------------------------------------
Traceback (most recent call last):
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/freeway/run_supervised_gnn.py", line 70, in <module>
    model.learn(total_timesteps=1000000, callback=[WandbCallback()])
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 313, in learn
    self.train()
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 217, in train
    values, log_prob, entropy = self.policy.evaluate_actions(rollout_data.observations, actions)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 730, in evaluate_actions
    features = self.extract_features(obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 672, in extract_features
    return super().extract_features(obs, self.features_extractor if features_extractor is None else features_extractor)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 131, in extract_features
    return features_extractor(preprocessed_obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/model/policy.py", line 40, in forward
    pyg_data = self.encoder.encode(observations)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/encoder/GraphEncoder.py", line 229, in encode
    return Batch.from_data_list(self.to_pyg_data(batch_data))
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/encoder/GraphEncoder.py", line 258, in to_pyg_data
    flattened_features = [f.view(-1) for f in features_list]
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/encoder/GraphEncoder.py", line 258, in <listcomp>
    flattened_features = [f.view(-1) for f in features_list]
KeyboardInterrupt