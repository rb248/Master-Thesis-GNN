/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.seed to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.seed` for environment variables or `env.get_wrapper_attr('seed')` that will search the reminding wrappers.
  logger.warn(
Using cpu device
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 1000
Best mean reward: -inf - Last mean reward per episode: -802.50
Saving new best model at 112785 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 2000
Best mean reward: -802.50 - Last mean reward per episode: -795.30
Saving new best model at 113785 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 892      |
|    ep_rew_mean     | -436     |
| time/              |          |
|    fps             | 280      |
|    iterations      | 1        |
|    time_elapsed    | 7        |
|    total_timesteps | 2048     |
---------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 3000
Best mean reward: -795.30 - Last mean reward per episode: -771.28
Saving new best model at 114953 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
Num timesteps: 4000
Best mean reward: -771.28 - Last mean reward per episode: -765.26
Saving new best model at 115953 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 791         |
|    ep_rew_mean          | -381        |
| time/                   |             |
|    fps                  | 101         |
|    iterations           | 2           |
|    time_elapsed         | 40          |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.011331007 |
|    clip_fraction        | 0.11        |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.09       |
|    explained_variance   | -0.00367    |
|    learning_rate        | 0.0003      |
|    loss                 | 4.09        |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.00182    |
|    value_loss           | 7.33        |
-----------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 5000
Best mean reward: -765.26 - Last mean reward per episode: -709.38
Saving new best model at 116799 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
Eval num_timesteps=5000, episode_reward=-13.40 +/- 14.33
Episode length: 70.80 +/- 25.60
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 70.8        |
|    mean_reward          | -13.4       |
| time/                   |             |
|    total_timesteps      | 5000        |
| train/                  |             |
|    approx_kl            | 0.010823777 |
|    clip_fraction        | 0.0137      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.08       |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 21.2        |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.00153    |
|    value_loss           | 24.5        |
-----------------------------------------
New best mean reward!
Num timesteps: 6000
Best mean reward: -709.38 - Last mean reward per episode: -605.46
Saving new best model at 117933 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 429      |
|    ep_rew_mean     | -194     |
| time/              |          |
|    fps             | 80       |
|    iterations      | 3        |
|    time_elapsed    | 75       |
|    total_timesteps | 6144     |
---------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 7000
Best mean reward: -605.46 - Last mean reward per episode: -555.80
Saving new best model at 119083 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 8000
Best mean reward: -555.80 - Last mean reward per episode: -512.84
Saving new best model at 120018 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 301         |
|    ep_rew_mean          | -129        |
| time/                   |             |
|    fps                  | 71          |
|    iterations           | 4           |
|    time_elapsed         | 114         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.012231634 |
|    clip_fraction        | 0.0691      |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.03       |
|    explained_variance   | 1.19e-07    |
|    learning_rate        | 0.0003      |
|    loss                 | 36          |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0047     |
|    value_loss           | 62.9        |
-----------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 9000
Best mean reward: -512.84 - Last mean reward per episode: -464.64
Saving new best model at 121064 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 10000
Best mean reward: -464.64 - Last mean reward per episode: -420.33
Saving new best model at 122118 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
Eval num_timesteps=10000, episode_reward=-13.40 +/- 6.09
Episode length: 74.80 +/- 20.96
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 74.8        |
|    mean_reward          | -13.4       |
| time/                   |             |
|    total_timesteps      | 10000       |
| train/                  |             |
|    approx_kl            | 0.013849707 |
|    clip_fraction        | 0.0707      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.939      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 40.5        |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.00374    |
|    value_loss           | 85.6        |
-----------------------------------------
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 227      |
|    ep_rew_mean     | -91.6    |
| time/              |          |
|    fps             | 64       |
|    iterations      | 5        |
|    time_elapsed    | 157      |
|    total_timesteps | 10240    |
---------------------------------
Num timesteps: 11000
Best mean reward: -420.33 - Last mean reward per episode: -338.50
Saving new best model at 123420 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 12000
Best mean reward: -338.50 - Last mean reward per episode: -251.72
Saving new best model at 124425 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 182         |
|    ep_rew_mean          | -68.8       |
| time/                   |             |
|    fps                  | 61          |
|    iterations           | 6           |
|    time_elapsed         | 199         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.012819819 |
|    clip_fraction        | 0.196       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.835      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 98          |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0128     |
|    value_loss           | 118         |
-----------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 13000
Best mean reward: -251.72 - Last mean reward per episode: -155.93
Saving new best model at 125425 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 14000
Best mean reward: -155.93 - Last mean reward per episode: -71.14
Saving new best model at 126487 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 158         |
|    ep_rew_mean          | -56.7       |
| time/                   |             |
|    fps                  | 60          |
|    iterations           | 7           |
|    time_elapsed         | 235         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.010611003 |
|    clip_fraction        | 0.141       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.743      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 62.8        |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0108     |
|    value_loss           | 132         |
-----------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 15000
Best mean reward: -71.14 - Last mean reward per episode: -33.99
Saving new best model at 127483 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
Eval num_timesteps=15000, episode_reward=-15.00 +/- 6.96
Episode length: 74.00 +/- 16.05
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 74          |
|    mean_reward          | -15         |
| time/                   |             |
|    total_timesteps      | 15000       |
| train/                  |             |
|    approx_kl            | 0.004687199 |
|    clip_fraction        | 0.0347      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.678      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 41.5        |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0011     |
|    value_loss           | 107         |
-----------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 16000
Best mean reward: -33.99 - Last mean reward per episode: -28.53
Saving new best model at 128827 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 115      |
|    ep_rew_mean     | -35.2    |
| time/              |          |
|    fps             | 48       |
|    iterations      | 8        |
|    time_elapsed    | 335      |
|    total_timesteps | 16384    |
---------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 17000
Best mean reward: -28.53 - Last mean reward per episode: -25.52
Saving new best model at 129820 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 18000
Best mean reward: -25.52 - Last mean reward per episode: -24.91
Saving new best model at 130762 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 97.3         |
|    ep_rew_mean          | -26.1        |
| time/                   |              |
|    fps                  | 49           |
|    iterations           | 9            |
|    time_elapsed         | 373          |
|    total_timesteps      | 18432        |
| train/                  |              |
|    approx_kl            | 0.0029751598 |
|    clip_fraction        | 0.0567       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.654       |
|    explained_variance   | 5.96e-08     |
|    learning_rate        | 0.0003       |
|    loss                 | 35.9         |
|    n_updates            | 80           |
|    policy_gradient_loss | -0.0041      |
|    value_loss           | 96.6         |
------------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 19000
Best mean reward: -24.91 - Last mean reward per episode: -23.98
Saving new best model at 131769 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 20000
Best mean reward: -23.98 - Last mean reward per episode: -23.74
Saving new best model at 132762 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
Eval num_timesteps=20000, episode_reward=-9.00 +/- 5.06
Episode length: 62.00 +/- 6.20
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 62          |
|    mean_reward          | -9          |
| time/                   |             |
|    total_timesteps      | 20000       |
| train/                  |             |
|    approx_kl            | 0.002285616 |
|    clip_fraction        | 0.0664      |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.601      |
|    explained_variance   | 0           |
|    learning_rate        | 0.0003      |
|    loss                 | 47.4        |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.00259    |
|    value_loss           | 103         |
-----------------------------------------
New best mean reward!
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 93       |
|    ep_rew_mean     | -24.3    |
| time/              |          |
|    fps             | 49       |
|    iterations      | 10       |
|    time_elapsed    | 411      |
|    total_timesteps | 20480    |
---------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 21000
Best mean reward: -23.74 - Last mean reward per episode: -23.05
Saving new best model at 134034 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 22000
Best mean reward: -23.05 - Last mean reward per episode: -23.48
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 93.1         |
|    ep_rew_mean          | -24.5        |
| time/                   |              |
|    fps                  | 50           |
|    iterations           | 11           |
|    time_elapsed         | 448          |
|    total_timesteps      | 22528        |
| train/                  |              |
|    approx_kl            | 0.0007515813 |
|    clip_fraction        | 0.0106       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.609       |
|    explained_variance   | 0            |
|    learning_rate        | 0.0003       |
|    loss                 | 68.5         |
|    n_updates            | 100          |
|    policy_gradient_loss | 0.000148     |
|    value_loss           | 99.2         |
------------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 23000
Best mean reward: -23.05 - Last mean reward per episode: -23.45
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 24000
Best mean reward: -23.05 - Last mean reward per episode: -23.86
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 92.8         |
|    ep_rew_mean          | -24.5        |
| time/                   |              |
|    fps                  | 50           |
|    iterations           | 12           |
|    time_elapsed         | 483          |
|    total_timesteps      | 24576        |
| train/                  |              |
|    approx_kl            | 0.0009451277 |
|    clip_fraction        | 0.00977      |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.6         |
|    explained_variance   | 0            |
|    learning_rate        | 0.0003       |
|    loss                 | 42.3         |
|    n_updates            | 110          |
|    policy_gradient_loss | 0.000182     |
|    value_loss           | 95           |
------------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 25000
Best mean reward: -23.05 - Last mean reward per episode: -23.50
Eval num_timesteps=25000, episode_reward=-13.00 +/- 7.51
Episode length: 70.00 +/- 12.07
------------------------------------------
| eval/                   |              |
|    mean_ep_length       | 70           |
|    mean_reward          | -13          |
| time/                   |              |
|    total_timesteps      | 25000        |
| train/                  |              |
|    approx_kl            | 0.0016017051 |
|    clip_fraction        | 0.0064       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.586       |
|    explained_variance   | 0            |
|    learning_rate        | 0.0003       |
|    loss                 | 54.2         |
|    n_updates            | 120          |
|    policy_gradient_loss | 6.48e-05     |
|    value_loss           | 89.6         |
------------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 26000
Best mean reward: -23.05 - Last mean reward per episode: -21.70
Saving new best model at 139273 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 88.9     |
|    ep_rew_mean     | -23.1    |
| time/              |          |
|    fps             | 51       |
|    iterations      | 13       |
|    time_elapsed    | 520      |
|    total_timesteps | 26624    |
---------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 27000
Best mean reward: -21.70 - Last mean reward per episode: -21.68
Saving new best model at 140280 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 28000
Best mean reward: -21.68 - Last mean reward per episode: -21.00
Saving new best model at 141320 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 85.8         |
|    ep_rew_mean          | -21.5        |
| time/                   |              |
|    fps                  | 51           |
|    iterations           | 14           |
|    time_elapsed         | 557          |
|    total_timesteps      | 28672        |
| train/                  |              |
|    approx_kl            | 0.0027580368 |
|    clip_fraction        | 0.0258       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.52        |
|    explained_variance   | 5.96e-08     |
|    learning_rate        | 0.0003       |
|    loss                 | 54.7         |
|    n_updates            | 130          |
|    policy_gradient_loss | -0.00045     |
|    value_loss           | 86.5         |
------------------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 29000
Best mean reward: -21.00 - Last mean reward per episode: -20.79
Saving new best model at 142268 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 30000
Best mean reward: -20.79 - Last mean reward per episode: -19.91
Saving new best model at 143293 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
Eval num_timesteps=30000, episode_reward=-16.20 +/- 8.86
Episode length: 76.40 +/- 13.53
-----------------------------------------
| eval/                   |             |
|    mean_ep_length       | 76.4        |
|    mean_reward          | -16.2       |
| time/                   |             |
|    total_timesteps      | 30000       |
| train/                  |             |
|    approx_kl            | 0.003167063 |
|    clip_fraction        | 0.032       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.456      |
|    explained_variance   | -1.19e-07   |
|    learning_rate        | 0.0003      |
|    loss                 | 52.8        |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.00187    |
|    value_loss           | 98.6        |
-----------------------------------------
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 82.8     |
|    ep_rew_mean     | -19.9    |
| time/              |          |
|    fps             | 51       |
|    iterations      | 15       |
|    time_elapsed    | 597      |
|    total_timesteps | 30720    |
---------------------------------
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 31000
Best mean reward: -19.91 - Last mean reward per episode: -18.64
Saving new best model at 144662 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/monitor.py:250: FutureWarning: The behavior of DataFrame concatenation with empty or all-NA entries is deprecated. In a future version, this will no longer exclude empty or all-NA columns when determining the result dtypes. To retain the old behavior, exclude the relevant entries before the concat operation.
  data_frame = pandas.concat(data_frames)
Num timesteps: 32000
Best mean reward: -18.64 - Last mean reward per episode: -18.50
Saving new best model at 145645 timesteps
Saving new best model to ./logs/Freeway-GNN-training/best_model.zip
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 80.4         |
|    ep_rew_mean          | -18.5        |
| time/                   |              |
|    fps                  | 51           |
|    iterations           | 16           |
|    time_elapsed         | 632          |
|    total_timesteps      | 32768        |
| train/                  |              |
|    approx_kl            | 0.0010303552 |
|    clip_fraction        | 0.0152       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.386       |
|    explained_variance   | 0            |
|    learning_rate        | 0.0003       |
|    loss                 | 44.6         |
|    n_updates            | 150          |
|    policy_gradient_loss | -0.000684    |
|    value_loss           | 85.2         |
------------------------------------------
Traceback (most recent call last):
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/freeway/run_supervised_gnn.py", line 118, in <module>
    main()
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/freeway/run_supervised_gnn.py", line 112, in main
    model.learn(total_timesteps=1000000, callback=[WandbCallback(), save_best_callback, eval_callback])
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 315, in learn
    return super().learn(
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 313, in learn
    self.train()
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 217, in train
    values, log_prob, entropy = self.policy.evaluate_actions(rollout_data.observations, actions)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 730, in evaluate_actions
    features = self.extract_features(obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 672, in extract_features
    return super().extract_features(obs, self.features_extractor if features_extractor is None else features_extractor)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/stable_baselines3/common/policies.py", line 131, in extract_features
    return features_extractor(preprocessed_obs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/model/policy.py", line 40, in forward
    pyg_data = self.encoder.encode(observations)
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/encoder/GraphEncoder.py", line 340, in encode
    return Batch.from_data_list(self.to_pyg_data(batch_data))
  File "/Users/rishubbhatia/Documents/master thesis/Master-Thesis-GNN/games/encoder/GraphEncoder.py", line 396, in to_pyg_data
    data[edge_type].edge_index = edge_tensor
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch_geometric/data/hetero_data.py", line 180, in __getitem__
    out = self._global_store.get(key, None)
  File "/Users/rishubbhatia/miniforge3/envs/games/lib/python3.10/site-packages/torch_geometric/data/storage.py", line 207, in get
    return self._mapping.get(key, value)
KeyboardInterrupt