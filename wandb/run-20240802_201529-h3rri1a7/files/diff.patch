diff --git a/games/encoder/GraphEncoder.py b/games/encoder/GraphEncoder.py
index a0dbe69..db0aae5 100644
--- a/games/encoder/GraphEncoder.py
+++ b/games/encoder/GraphEncoder.py
@@ -399,13 +399,30 @@ class HeteroGNNEncoderPongProximity:
 
 #         return data_list
 
+def visualize_graph(graph: nx.Graph):
+        pos = nx.spring_layout(graph)
+        plt.figure(figsize=(12, 8))
+        node_labels = {node: f"{node}\n{attrs['type']}" for node, attrs in graph.nodes(data=True)}
+        edge_labels = {(src, dst): f"{attrs['position']}" for src, dst, attrs in graph.edges(data=True)}
+
+        nx.draw(graph, pos, with_labels=True, labels=node_labels, node_size=500, node_color='lightblue', font_size=10)
+        nx.draw_networkx_edge_labels(graph, pos, edge_labels=edge_labels, font_color='red')
+
+        plt.show()
+
+def print_graph_details(graph: nx.Graph):
+    print("Nodes:")
+    for node, attrs in graph.nodes(data=True):
+        print(f"  Node {node}: Type: {attrs['type']}, Features: {attrs['features']}")
+    
+    print("Edges:")
+    for src, dst, attrs in graph.edges(data=True):
+        print(f"  Edge from {src} to {dst}: Position: {attrs['position']}")
 class GraphEncoderFreeway:
     def __init__(self, obj_type_id: str = "obj"):
         self.obj_type_id = obj_type_id
 
-    def encode(self, batch_node_features: torch.Tensor, proximity_threshold: float = 50) -> Batch:
-        # remove the values from batch_node_features that have all zeros in the vector
-        # batch_node_features = batch_node_features[~torch.all(batch_node_features == 0, dim=1)]
+    def encode(self, batch_node_features: torch.Tensor) -> Batch:
         batch_data = []
         batch_size = batch_node_features.size(0)
 
@@ -428,7 +445,7 @@ class GraphEncoderFreeway:
 
             for i in chicken_indices:
                 for j in lane_indices:
-                    if abs(node_features[i, 1] - node_features[j, 1]) <= proximity_threshold:
+                    if node_features[i, 1] == node_features[j, 1]:  # Check if y-coordinates are the same
                         atom_features = torch.zeros((2, object_feature_length)).tolist()
                         graph.add_node(atom_index, type="ChickenOnLane", features=atom_features)
                         graph.add_edge(i, atom_index, position=0)
@@ -440,7 +457,7 @@ class GraphEncoderFreeway:
 
             for i in car_indices:
                 for j in lane_indices:
-                    if abs(node_features[i, 1] - node_features[j, 1]) <= proximity_threshold:
+                    if node_features[i, 1] == node_features[j, 1]:  # Check if y-coordinates are the same
                         atom_features = torch.zeros((2, object_feature_length)).tolist()
                         graph.add_node(atom_index, type="CarOnLane", features=atom_features)
                         graph.add_edge(i, atom_index, position=0)
@@ -459,7 +476,7 @@ class GraphEncoderFreeway:
 
         return Batch.from_data_list(self.to_pyg_data(batch_data))
 
-    def to_pyg_data(self, batch_graphs: List[nx.Graph]) -> List[HeteroData]:
+    def to_pyg_data(self, batch_graphs: list[nx.Graph]) -> list[HeteroData]:
         data_list = []
 
         for graph in batch_graphs:
@@ -515,6 +532,8 @@ class GraphEncoderFreeway:
             data_list.append(data)
 
         return data_list
+
+    
 class GraphEncoderFreewayProximity:
     def __init__(self, obj_type_id: str = "obj"):
         self.obj_type_id = obj_type_id
diff --git a/games/encoder/__pycache__/GraphEncoder.cpython-310.pyc b/games/encoder/__pycache__/GraphEncoder.cpython-310.pyc
index b9ee24e..610a0b0 100644
Binary files a/games/encoder/__pycache__/GraphEncoder.cpython-310.pyc and b/games/encoder/__pycache__/GraphEncoder.cpython-310.pyc differ
diff --git a/games/freeway/__pycache__/run_supervised_gnn.cpython-310.pyc b/games/freeway/__pycache__/run_supervised_gnn.cpython-310.pyc
index 1e98d70..20ad639 100644
Binary files a/games/freeway/__pycache__/run_supervised_gnn.cpython-310.pyc and b/games/freeway/__pycache__/run_supervised_gnn.cpython-310.pyc differ
diff --git a/games/freeway/freeway_envs/__pycache__/freeway_env.cpython-310.pyc b/games/freeway/freeway_envs/__pycache__/freeway_env.cpython-310.pyc
index 07abeb1..6352f36 100644
Binary files a/games/freeway/freeway_envs/__pycache__/freeway_env.cpython-310.pyc and b/games/freeway/freeway_envs/__pycache__/freeway_env.cpython-310.pyc differ
diff --git a/games/freeway/freeway_envs/freeway_env.py b/games/freeway/freeway_envs/freeway_env.py
index ae1b6af..7a3c762 100644
--- a/games/freeway/freeway_envs/freeway_env.py
+++ b/games/freeway/freeway_envs/freeway_env.py
@@ -507,8 +507,8 @@ class FreewayEnvConstant(gym.Env):
         # lane_combinations = [[60, 90], [60, 90, 120], [60, 120]]
         # # 
         #lane_combinations =[[50,80,120],[50,80],[80,120],[50,120]]
-        #lane_combinations = [[30, 60, 90, 120, 150]]
-        lane_combinations = [[50, 80, 120]]
+        lane_combinations = [[30, 60, 90, 120, 150]]
+        #lane_combinations = [[50, 80, 120]]
         number_cars = [10,15]
         car_speeds = [3]
 
@@ -998,10 +998,12 @@ class FreewayEnvDynamic(gym.Env):
 
 
 if __name__=="__main__":
-    env = FreewayEnvTest(render_mode='human', observation_type='graph')
-
-    #model = PPO.load("ppo_freeway_pixel")
-    model = PPO.load("logs/Freeway-GNN-training/best_model.zip")
+    #env = FreewayEnvDynamic(render_mode='human', observation_type='graph')
+    env = FreewayEnvDynamic(render_mode='human', observation_type='pixel')
+    model = PPO.load("ppo_freeway_pixel")
+    #model = PPO.load("logs/Freeway-GNN-training/best_model.zip")
+    #model = PPO.load("ppo_freeway_curriculum_2.zip")
+    #model = PPO.load("freeway-gnn-eval.zip")
     #model = PPO.load("ppo_custom_heterognn")
     obs,_ = env.reset()
     done = False
diff --git a/games/freeway/run_supervised_gnn.py b/games/freeway/run_supervised_gnn.py
index 4cfdf0a..07b6d5d 100644
--- a/games/freeway/run_supervised_gnn.py
+++ b/games/freeway/run_supervised_gnn.py
@@ -235,7 +235,7 @@ log_dir = "./logs/Freeway-GNN-training/"
 
 def make_env(lanes, max_cars, car_speed, seed=0, rank=None):
     def _init():
-        env = FreewayEnvTest( render_mode='human', observation_type='graph')
+        env = FreewayEnvDynamic( render_mode='human', observation_type='graph')
         monitor_path = os.path.join(log_dir, f"monitor_{rank}.csv")
         os.makedirs(log_dir, exist_ok=True)  # Create log directory if it doesn't exist
         env = Monitor(env, filename=monitor_path, allow_early_resets=True)
diff --git a/games/model/__pycache__/hetero_message_passing.cpython-310.pyc b/games/model/__pycache__/hetero_message_passing.cpython-310.pyc
index 8b90800..47b2f7f 100644
Binary files a/games/model/__pycache__/hetero_message_passing.cpython-310.pyc and b/games/model/__pycache__/hetero_message_passing.cpython-310.pyc differ
diff --git a/games/model/__pycache__/policy.cpython-310.pyc b/games/model/__pycache__/policy.cpython-310.pyc
index 9044bb9..ba640cd 100644
Binary files a/games/model/__pycache__/policy.cpython-310.pyc and b/games/model/__pycache__/policy.cpython-310.pyc differ
diff --git a/logs/Freeway-GNN-training/monitor_0.csv.monitor.csv b/logs/Freeway-GNN-training/monitor_0.csv.monitor.csv
index 48dc5a8..3eaa7d7 100644
--- a/logs/Freeway-GNN-training/monitor_0.csv.monitor.csv
+++ b/logs/Freeway-GNN-training/monitor_0.csv.monitor.csv
@@ -1,33 +1,2 @@
-#{"t_start": 1722538752.493021, "env_id": "None"}
+#{"t_start": 1722622527.67328, "env_id": "None"}
 r,l,t
--1024.5,2049,71.239367
--1024.0,2048,134.616509
--1062.5,2125,194.623773
--974.0,2008,254.629861
--975.5,2011,315.903349
--979.5,2079,375.907573
--828.5,2017,441.423629
--814.0,2048,508.913724
--604.0,2048,575.270796
--544.0,2048,643.680322
--334.0,2048,712.710081
--304.0,2048,777.798116
--214.0,2048,842.636858
--409.0,2078,902.640861
--259.0,2018,964.275593
--274.0,2048,1024.99233
--386.0,2152,1084.995663
--222.0,1944,1149.779988
--154.0,2048,1211.176031
--364.0,2048,1273.837377
--244.0,2048,1340.420099
--244.0,2048,1406.638014
--64.0,2048,1471.509567
--214.0,2048,1542.852116
--124.0,2048,1608.17152
--364.0,2048,1673.883667
--124.0,2048,1740.133424
--274.0,2048,1811.237361
--304.0,2048,1877.319834
--244.0,2048,1945.873189
--64.0,2048,2011.776907
diff --git a/ppo_custom_heterognn_Freeway.zip b/ppo_custom_heterognn_Freeway.zip
index 2ab5bea..4df678f 100644
Binary files a/ppo_custom_heterognn_Freeway.zip and b/ppo_custom_heterognn_Freeway.zip differ
diff --git a/wandb/debug-internal.log b/wandb/debug-internal.log
index 1fdb4ed..6ea47f6 120000
--- a/wandb/debug-internal.log
+++ b/wandb/debug-internal.log
@@ -1 +1 @@
-run-20240801_205915-0qp8eooh/logs/debug-internal.log
\ No newline at end of file
+run-20240802_201529-h3rri1a7/logs/debug-internal.log
\ No newline at end of file
diff --git a/wandb/debug.log b/wandb/debug.log
index bf33139..4b5782c 120000
--- a/wandb/debug.log
+++ b/wandb/debug.log
@@ -1 +1 @@
-run-20240801_205915-0qp8eooh/logs/debug.log
\ No newline at end of file
+run-20240802_201529-h3rri1a7/logs/debug.log
\ No newline at end of file
diff --git a/wandb/latest-run b/wandb/latest-run
index bda545f..6caa395 120000
--- a/wandb/latest-run
+++ b/wandb/latest-run
@@ -1 +1 @@
-run-20240801_205915-0qp8eooh
\ No newline at end of file
+run-20240802_201529-h3rri1a7
\ No newline at end of file
